# ğŸ—ƒï¸ BedrockBackup

**MinecraftåŸºå²©ç‰ˆæœåŠ¡å™¨å¤‡ä»½è§£å†³æ–¹æ¡ˆ**

---

## ğŸ“¦ åŠŸèƒ½æ¦‚è§ˆ

- **å¤‡ä»½/æ¢å¤**ï¼šæ”¯æŒå…¨é‡/å·®å¼‚å¤‡ä»½ï¼Œå¿«é€Ÿå›æ»šå­˜æ¡£
- **åˆ é™¤/æŸ¥è¯¢**ï¼šåˆ é™¤å’ŒæŸ¥è¯¢å…¨é‡/å·®å¼‚å¤‡ä»½
- **å®šæ—¶ä»»åŠ¡**ï¼šè‡ªåŠ¨å¤‡ä»½ã€è‡ªåŠ¨æ¸…ç†
- **å¤šæ¨¡å¼è§¦å‘**ï¼šå®šæ—¶å¤‡ä»½æˆ–æŒ‰å›ºå®šé—´éš”æ‰§è¡Œ
- **å®‰å…¨é˜²æŠ¤**ï¼šå¯åŠ¨/å›æ»šæ“ä½œå‰è‡ªåŠ¨åˆ›å»ºä¿é™©å¤‡ä»½

---

## ğŸ’¡ å·¥ä½œåŸç†

`MCSL-T.exe` åŸºäº Windows API ç®¡é“é€šä¿¡ï¼Œå¹¶æŒ‚è½½ `BedrockBackup.dll` å®ç°å­˜æ¡£å¤‡ä»½ç®¡ç†

---

## ğŸ› ï¸ å®‰è£…ä¸é…ç½®

### 1. æ–‡ä»¶ç»“æ„

```js
MCSL-T/
â”œâ”€â”€ .backups/                # å¤‡ä»½å­˜æ¡£å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ full/                # å…¨å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ differential/        # å·®å¼‚å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ rollback_temp_path/  # å›æ»šå‰ä¸´æ—¶å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ startup_temp_path/   # å¯åŠ¨å‰ä¸´æ—¶å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â””â”€â”€ log/                 # BedrockBackup æ“ä½œæ—¥å¿—è®°å½•
â”‚
â”œâ”€â”€ .dll/ # æ’ä»¶ç›®å½•
|   â”œâ”€â”€ BedrockBackup/                  # å¤‡ä»½æ’ä»¶ç›®å½•
â”‚   	â”œâ”€â”€ BedrockBackup.dll           # å¤‡ä»½æ’ä»¶
â”‚   	â””â”€â”€ BedrockBackup_Config.json   # é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ .server_bedrock/         # BDSæœåŠ¡å™¨å­˜æ”¾ç›®å½•
â”‚
â””â”€â”€ MCSL-T.exe               # ä¸»ç¨‹åº
```

### 2. é¦–æ¬¡è¿è¡Œ

1. ç¡®ä¿`BedrockBackup.dll`åœ¨`.dll/BedrockBackup/`ç›®å½•ä¸­
2. å¯åŠ¨`MCSL-T.exe`ï¼Œè‡ªåŠ¨ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶

---

## âš™ï¸ é…ç½®æ–‡ä»¶è¯¦è§£

### å¤‡ä»½ç­–ç•¥ (`backup_strategy`)

```json
{
  "current_backup_type": "Full",  // Fullï¼ˆå…¨é‡ï¼‰æˆ– Differentialï¼ˆå·®å¼‚ï¼‰
  "auto_backup": {
    "enabled": true,                      // è‡ªåŠ¨å¤‡ä»½
    "trigger_mode": "TimeInterval",       // TimeIntervalï¼ˆé—´éš”è§¦å‘ï¼‰æˆ– ScheduledTimeï¼ˆå®šæ—¶è§¦å‘ï¼‰
    "interval_minutes": 480,              // é—´éš”åˆ†é’Ÿæ•°ï¼ˆä»…TimeIntervalæ¨¡å¼æœ‰æ•ˆï¼‰
    "scheduled_times": [                  // å®šæ—¶è§¦å‘æ—¶é—´ç‚¹ï¼ˆä»…ScheduledTimeæ¨¡å¼æœ‰æ•ˆï¼‰
      {05, 00}, // é»˜è®¤è®¡åˆ’æ—¶é—´1: å‡Œæ™¨5ç‚¹
      {13, 00}, // é»˜è®¤è®¡åˆ’æ—¶é—´2: ä¸‹åˆ1ç‚¹ 
      {23, 00}  // é»˜è®¤è®¡åˆ’æ—¶é—´3: æ™šä¸Š11ç‚¹      
    ]
  }
}
```

### è‡ªåŠ¨æ¸…ç† (`auto_cleanup`)

```json
{
  "enabled": true,                        // å¯åŠ¨æ¸…ç†
  "cleanup_mode": "ByAge",                // æ¸…ç†æ¨¡å¼ï¼ˆByAge/ByCountç­‰ï¼‰
  "max_backup_age_hours": 24,             // ä¿ç•™æœ€è¿‘72å°æ—¶çš„å¤‡ä»½
  "max_backups_to_keep": 10               // æœ€å¤šä¿ç•™10ä¸ªå¤‡ä»½
}
```

### å®‰å…¨ç®¡ç† (`safety_config`)

```json
{
  "startup_safety": {
    "keep_startup_backups": true,     // æœåŠ¡å™¨å¯åŠ¨å‰è‡ªåŠ¨å¤‡ä»½
    "max_startup_backups_to_keep": 2  // ä¿ç•™(n+1)æ¬¡å¯åŠ¨å¤‡ä»½
  },

  "rollback_safety": {
    "keep_rollback_backups": true,    // æœåŠ¡å™¨å›æ»šå‰è‡ªåŠ¨å¤‡ä»½
    "max_rollback_backups_to_keep": 3 // ä¿ç•™(n+1)æ¬¡å›æ»šå¤‡ä»½
  }
}
```

### ç³»ç»Ÿé™åˆ¶ (`system_limits`)

```json
{
  "minimum_required_disk_space_gb": 30 // åˆ›å»ºå¤‡ä»½æ—¶ç£ç›˜è‡³å°‘æ‰€éœ€ç©ºé—´ (GB)
}
```

## â“ å¸¸è§é—®é¢˜

**Qï¼šå·®å¼‚å¤‡ä»½å¦‚ä½•å·¥ä½œï¼Ÿ**
Aï¼šåŸºäºå‰ä¸€ä¸ªå…¨é‡å¤‡ä»½ï¼Œä»…ä¿å­˜å˜åŒ–çš„æ•°æ®

**Qï¼šå¤‡ä»½å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**

1. æ£€æŸ¥ `.backups/log/` ä¸­çš„é”™è¯¯æ—¥å¿—
2. ç¡®è®¤ç£ç›˜å‰©ä½™ç©ºé—´ > è®¾ç½®çš„å¤§å°
3. é‡å¯æœåŠ¡å™¨åé‡è¯•

---

## ğŸ“œ æœ¬é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹ç¬¬ä¸‰æ–¹åº“ï¼š

```
[nlohmann/json](https://github.com/nlohmann/json)
[Zip-Utils](https://www.codeproject.com/KB/files/zip_utils/zip_utils_src.zip)
```


