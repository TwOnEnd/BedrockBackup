# ğŸ—ƒï¸ BedrockBackup

**MinecraftåŸºå²©ç‰ˆæœåŠ¡ç«¯å¤šç­–ç•¥å¤‡ä»½è§£å†³æ–¹æ¡ˆ**

---
![img](img.png)

## ğŸ“¦ åŠŸèƒ½æ¦‚è§ˆ

- **çƒ­å¤‡ä»½/æ¢å¤**ï¼šæ”¯æŒå…¨é‡/å·®å¼‚å¤‡ä»½ï¼Œå¿«é€Ÿå›æ»šå­˜æ¡£
- **åˆ é™¤/æŸ¥è¯¢**ï¼šåˆ é™¤å’ŒæŸ¥è¯¢å…¨é‡/å·®å¼‚å¤‡ä»½
- **å®šæ—¶ä»»åŠ¡**ï¼šè‡ªåŠ¨å¤‡ä»½ã€è‡ªåŠ¨æ¸…ç†
- **å¤šæ¨¡å¼è§¦å‘**ï¼šå®šæ—¶å¤‡ä»½æˆ–æŒ‰å›ºå®šé—´éš”æ‰§è¡Œ
- **å®‰å…¨é˜²æŠ¤**ï¼šä½¿ç”¨åŸç”ŸæŒ‡ä»¤ä¿è¯å­˜æ¡£å®Œæ•´æ€§ã€å¯åŠ¨/å›æ»šæ“ä½œå‰è‡ªåŠ¨åˆ›å»ºä¿é™©å¤‡ä»½ç­‰

## ğŸ’¡ å·¥ä½œåŸç†

1. `MCSL-T.exe`ä½¿ç”¨ Windows API ç®¡é“ä¸`bedrock_server.exe`é€šä¿¡ï¼Œå¹¶åŠ è½½ `BedrockBackup.dll`
2. åˆ›å»ºå¤‡ä»½æ—¶ï¼Œä½¿ç”¨`bedrock_server.exe`åŸç”ŸæŒ‡ä»¤`/save hold|query|resume`ï¼Œç¡®ä¿å­˜æ¡£å®Œæ•´æ€§ï¼›
   å‚è€ƒï¼šä¸`bedrock_server.exe`åŒç›®å½•çš„æ–‡ä»¶`bedrock_server_how_to.html`ï¼Œä¸­çš„ã€Backupsã€‘éƒ¨åˆ†

## ğŸ› ï¸ å®‰è£…ä¸é…ç½®

### 1. æ–‡ä»¶ç»“æ„

```
MCSL-T/
â”œâ”€â”€ .backups/                # å¤‡ä»½å­˜æ¡£å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ full/                # å…¨å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ diff/                # å·®å¼‚å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ rollback/            # å›æ»šå‰ä¸´æ—¶å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â”œâ”€â”€ startup/             # å¯åŠ¨å‰ä¸´æ—¶å¤‡ä»½ å­˜æ”¾ç›®å½•
â”‚   â””â”€â”€ logs/                # å¤‡ä»½æ’ä»¶æ“ä½œæ—¥å¿—è®°å½•
â”‚
â”œâ”€â”€ .dll/ # æ’ä»¶ç›®å½•
â”‚   â””â”€â”€ BedrockBackup/                  # å¤‡ä»½æ’ä»¶ç›®å½•
â”‚   	â”œâ”€â”€ BedrockBackup.dll           # å¤‡ä»½æ’ä»¶
â”‚   	â””â”€â”€ BedrockBackup_config.json   # é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ .server_bedrock/         # BDSæœåŠ¡ç«¯å­˜æ”¾ç›®å½•
â”‚
â””â”€â”€ MCSL-T.exe               # ä¸»ç¨‹åº
```

### 2. é¦–æ¬¡è¿è¡Œ

1. ç¡®ä¿`BedrockBackup.dll`åœ¨`.dll/BedrockBackup/`ç›®å½•ä¸­
2. å¯åŠ¨`MCSL-T.exe`ï¼Œè‡ªåŠ¨ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶

## ğŸ“Œ ä½¿ç”¨BedrockBackupåŠŸèƒ½

### 1. åˆ›å»ºå¤‡ä»½ `backup make [note]`

```
æ ¹æ®å½“å‰å¤‡ä»½ç±»å‹ åˆ›å»ºä¸€ä¸ªå¤‡ä»½
[note]: ç»™åˆ›å»ºçš„å¤‡ä»½ä¸€ä¸ªæ³¨é‡Šï¼Œè‹¥ä¸å¡«ï¼Œé»˜è®¤ä¸ºâ€œç©ºâ€
ä¾‹ï¼šbackup make æˆ‘æ˜¯ä¸€ä¸ªå¤‡ä»½
åˆ›å»ºä¸€ä¸ª.zipå¤‡ä»½ï¼Œå¹¶ç»™è¯¥å¤‡ä»½åç§°æ·»åŠ â€œæˆ‘æ˜¯ä¸€ä¸ªå¤‡ä»½â€
```

### 2. åˆ é™¤å¤‡ä»½ `backup remove [index]`

```
æ ¹æ®å½“å‰å¤‡ä»½ç±»å‹ åˆ é™¤é€‰æ‹©çš„å¤‡ä»½
[index]: é€‰æ‹©è¦åˆ é™¤å¤‡ä»½çš„ç¼–å·ï¼ŒæŸ¥çœ‹ç¼–å·ç”¨"backup list [pag]"æŒ‡ä»¤æŸ¥çœ‹
ä¾‹ï¼šbackup remove 5
åˆ é™¤é€‰æ‹©ç¼–å·ä¸º 5 çš„å¤‡ä»½
```

### 3. åˆ—å‡ºå¤‡ä»½ `backup list [pag]`

```
æŸ¥çœ‹å½“å‰å¤‡ä»½ç±»å‹çš„å…¨éƒ¨å¤‡ä»½ ä¸ ä¿¡æ¯çŠ¶æ€
[pag]: é€‰æ‹©æŸ¥çœ‹çš„é¡µç 
ä¾‹ï¼šbackup list 2
æŸ¥çœ‹ç¬¬ 2 é¡µçš„å¤‡ä»½`
```

### 4. å›æ»šå¤‡ä»½ `backup restore [index]`

```
æ ¹æ®å½“å‰å¤‡ä»½ç±»å‹ å›æ»šé€‰æ‹©çš„å¤‡ä»½
[index]: é€‰æ‹©è¦å›æ»šå¤‡ä»½çš„ç¼–å·ï¼ŒæŸ¥çœ‹ç¼–å·ç”¨"backup list [pag]"æŒ‡ä»¤æŸ¥çœ‹
ä¾‹ï¼šbackup restore 9
å›æ»šé€‰æ‹©ç¼–å·ä¸º 9 çš„å¤‡ä»½
```

### 5. é‡è½½é…ç½®æ–‡ä»¶ `backup reload`

```
ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œè¾“å…¥æŒ‡ä»¤å³å¯é‡è½½é…ç½®æ–‡ä»¶
æ³¨æ„ï¼šè‡ªåŠ¨åˆ›å»º/æ¸…ç†å¤‡ä»½åŠŸèƒ½å¼€å…³ï¼Œæ— æ³•çƒ­é‡è½½ï¼Œå¿…é¡»é‡å¯
```

### 6. å¸®åŠ© `backup help`

```
å¦‚æœå¿˜äº†ä¸Šè¿°æŒ‡ä»¤ï¼Œè¾“å…¥è¿™ä¸ªå³å¯...
```

## âš™ï¸ é…ç½®æ–‡ä»¶è¯¦è§£

### å¤‡ä»½ç­–ç•¥ (`backup_strategy`)

```
{
  // å¤‡ä»½æ¨¡å¼
  // Full           å…¨å¤‡ä»½ - å¤‡ä»½æ‰€æœ‰å­˜æ¡£æ–‡ä»¶
  // Differential   å·®å¼‚å¤‡ä»½ - åªå¤‡ä»½è‡ªä¸Šæ¬¡å…¨å¤‡ä»½ä»¥æ¥çš„å˜åŒ–
  "current_backup_type": "Full", // é»˜è®¤: Full

  // è‡ªåŠ¨å¤‡ä»½
  "auto_backup": {
    // å¼€å…³
    "enabled": true, // é»˜è®¤: true

	// è‡ªåŠ¨å¤‡ä»½æ¨¡å¼
	// TimeInterval   æŒ‰å›ºå®šæ—¶é—´é—´éš”è§¦å‘å¤‡ä»½
	// ScheduledTime  æŒ‰æŒ‡å®šæ—¶é—´ç‚¹è§¦å‘å¤‡ä»½
    "trigger_mode": "TimeInterval", // é»˜è®¤: TimeInterval

	// æŒ‰å›ºå®šæ—¶é—´é—´éš”è§¦å‘å¤‡ä»½ (åˆ†é’Ÿ)
	// å½“trigger_modeä¸ºTimeIntervalæ—¶æœ‰æ•ˆ
    "interval_minutes": 480, // é»˜è®¤: 480 | ä¸å¯å°äº30

	// æŒ‰æŒ‡å®šæ—¶é—´ç‚¹è§¦å‘å¤‡ä»½
	// å½“trigger_modeä¸ºScheduledTimeæ—¶æœ‰æ•ˆ
    "scheduled_times": [
      {05, 00}, // é»˜è®¤è®¡åˆ’æ—¶é—´1: å‡Œæ™¨5ç‚¹
      {13, 00}, // é»˜è®¤è®¡åˆ’æ—¶é—´2: ä¸‹åˆ1ç‚¹
      {23, 00}  // é»˜è®¤è®¡åˆ’æ—¶é—´3: æ™šä¸Š11ç‚¹
    ]
  }
}
```

### è‡ªåŠ¨æ¸…ç† (`auto_cleanup`)

```
{
  // å¼€å…³
  "enabled": false, // é»˜è®¤: false

  // æ¸…ç†æ¨¡å¼
  // ByAge,                // åˆ é™¤è¶…è¿‡æœ€å¤§ä¿ç•™æ—¶é—´çš„å¤‡ä»½
  // ByAgeAndAutoCreated,  // åˆ é™¤è¶…è¿‡æœ€å¤§ä¿ç•™æ—¶é—´ä¸”ç”±è‡ªåŠ¨åˆ›å»ºçš„å¤‡ä»½
  // ByCount,              // åªä¿ç•™æœ€è¿‘Nä¸ªå¤‡ä»½
  // ByCountAndAutoCreated // åªä¿ç•™æœ€è¿‘Nä¸ªä¸”ç”±è‡ªåŠ¨åˆ›å»ºçš„å¤‡ä»½
  "cleanup_mode": "ByAge", // é»˜è®¤: ByAge

  // æ£€æŸ¥æ¸…ç†æ—¶é—´ (åˆ†é’Ÿ)	  
  "check_interval_minutes": 480, // é»˜è®¤: 480 | ä¸å¯å°äº30

  // æœ€å¤§ä¿ç•™æ—¶é—´ (å°æ—¶)
  // å½“cleanup_modeä¸ºByAgeæˆ–ByAgeAndAutoCreatedæ—¶æœ‰æ•ˆ
  "max_backup_age_hours": 24, // é»˜è®¤: 24

  // æœ€å¤§ä¿ç•™ä¸ªæ•°
  // å½“cleanup_modeä¸ºByCountæˆ–ByCountAndAutoCreatedæ—¶æœ‰æ•ˆ
  "max_backups_to_keep": 5, // é»˜è®¤: 5
}
```

### å®‰å…¨ç®¡ç† (`safety_config`)

```
{
  // å¯åŠ¨å‰å¤‡ä»½
  "startup_safety": {
	// å¼€å…³
    "keep_startup_backups": true, // é»˜è®¤: true

	// å¯åŠ¨å‰å¤‡ä»½çš„æœ€å¤§ä¿ç•™ä¸ªæ•° (n+1)
    "max_startup_backups_to_keep": 2 // é»˜è®¤: 2
  },

  // å›æ»šå‰å¤‡ä»½
  "rollback_safety": {
	// å¼€å…³
    "keep_rollback_backups": true, // é»˜è®¤: true
	
	// å›æ»šå‰å¤‡ä»½çš„æœ€å¤§ä¿ç•™ä¸ªæ•° (n+1)
    "max_rollback_backups_to_keep": 3 // é»˜è®¤: 3
  }
}
```

### ç³»ç»Ÿé™åˆ¶ (`system_limits`)

```
{
  // åˆ›å»ºå¤‡ä»½æ—¶ç£ç›˜è‡³å°‘æ‰€éœ€ç©ºé—´ (GB)
  "minimum_required_disk_space_gb": 30 // é»˜è®¤: 30
}
```

## â“ å¸¸è§é—®é¢˜

**Qï¼šè¿™æ˜¯ä»€ä¹ˆï¼Œ~~å‰é¢å½é‡Œå’•å™œçš„è¯´ä»€ä¹ˆå‘¢ï¼Œçœ‹ä¸æ‡‚~~**

`Aï¼šè¿™æ˜¯æˆ‘çš„ä¸–ç•ŒæœåŠ¡ç«¯åœ°å›¾å­˜æ¡£å¤‡ä»½å·¥å…·ï¼Œç”¨æ¥ä¿è¯æ¸¸æˆå­˜æ¡£çš„å®‰å…¨`

---

**Qï¼šæ”¯æŒå“ªç§æœåŠ¡ç«¯ï¼ŒJavaç‰ˆæœåŠ¡ç«¯å¯ä»¥å—ï¼Ÿ**

`Aï¼šä»…æ”¯æŒåŸºå²©ç‰ˆæœåŠ¡ç«¯ï¼ˆBDSï¼‰`
ä½œè€…å°è¯•è¿‡Javaç‰ˆæœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å¯ä»¥æ­£å¸¸è¿è¡Œï¼ˆä¸å«BedrockBackupåŠŸèƒ½ï¼‰
å¦‚æœæƒ³è¿è¡ŒJavaç‰ˆæœåŠ¡ç«¯ï¼Œæœ‰æ›´å¥½çš„é€‰æ‹©[MCDReforged](https://mcdreforged.com/zh-CN "MCDReforged")

---

**Qï¼šå¤‡ä»½çš„æ—¶å€™éœ€è¦å…³é—­æœåŠ¡ç«¯å—ï¼Ÿ**

`Aï¼šæ— éœ€å…³é—­æœåŠ¡ç«¯å°±å¯ä»¥è¿›è¡Œå¤‡ä»½ï¼ˆçƒ­å¤‡ä»½ï¼‰`
å¦å¤–ï¼Œå¯åŠ¨å‰/å›æ¡£å‰å¤‡ä»½è¿™ä¸¤ç§æ˜¯å†·å¤‡ä»½

---

**Qï¼šæœåŠ¡ç«¯åœ¨è¿è¡Œä¸­è¿›è¡Œå¤‡ä»½ï¼Œèƒ½ä¿è¯å¤‡ä»½åæ•°æ®çš„å®Œæ•´æ€§å—ï¼Ÿ**

`Aï¼šèƒ½çš„ï¼Œå…„å¼Ÿèƒ½çš„`ï¼ˆæœ¬æ–¹æ¡ˆçš„ä¼˜ç‚¹ä¹‹ä¸€ï¼Œä½¿ç”¨äº†æœåŠ¡ç«¯åŸç”Ÿ/save queryæŒ‡ä»¤ï¼ŒBedrockBackupèƒ½æ ¹æ®å…¶å†…å®¹è¿›è¡Œå¤åˆ¶å’Œæˆªæ–­

---

**Qï¼šå·®å¼‚å¤‡ä»½å¦‚ä½•å·¥ä½œï¼Ÿ**

Aï¼šåŸºäºå½“æœˆçš„å…¨é‡å¤‡ä»½ï¼Œä»…ä¿å­˜å˜åŒ–çš„æ•°æ®

---

**Qï¼šå¤‡ä»½å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**

1. æ£€æŸ¥ `.backups/logs/` ä¸­çš„æ—¥å¿—
2. ç¡®è®¤ç£ç›˜å‰©ä½™ç©ºé—´ > `BedrockBackup_config.json`ä¸­è®¾ç½®çš„å¤§å°
3. é‡å¯æœåŠ¡ç«¯åé‡è¯•

---

**Qï¼šè¿˜æœ‰æ›´å¤šé—®é¢˜ï¼Ÿ**

`A1ï¼šæ¬¢è¿åŠ ç¾¤æé—®ï¼ŒQQç¾¤ï¼š1001583480`

`A2ï¼šæœ‰bugï¼Œè¯·æäº¤issuesï¼Œå¹¶è¯¦ç»†è¯´æ˜é—®é¢˜`

## âœ¨ æ”¯æŒä½œè€…

â­ï¸Starï¼šç»™æœ¬é¡¹ç›®ç‚¹ä¸ªStarğŸ˜‹

âš¡[çˆ±å‘ç”µ](https://afdian.com/a/TwOnEnd)ï¼šhttps://afdian.com/a/TwOnEnd

## ğŸ“œ æœ¬é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹ç¬¬ä¸‰æ–¹åº“ï¼š

[nlohmann/json](https://github.com/nlohmann/json)

[Zip-Utils](https://www.codeproject.com/KB/files/zip_utils/zip_utils_src.zip)


